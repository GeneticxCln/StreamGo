<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamGo - Modern Media Center</title>
    <link rel="stylesheet" href="styles.css">
    <style>
      /* Context Menu Styles */
      .context-menu,
      .context-submenu {
        position: fixed;
        display: none;
        min-width: 220px;
        background: var(--background-secondary);
        border: 1px solid var(--border-color);
        border-radius: 10px;
        box-shadow: var(--shadow-lg);
        z-index: 10000;
        padding: 6px 0;
        backdrop-filter: blur(10px);
      }
      .context-menu-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 14px;
        font-size: 14px;
        color: var(--text-primary);
        cursor: pointer;
        user-select: none;
      }
      .context-menu-item svg { flex-shrink: 0; }
      .context-menu-item:hover { background: var(--background-tertiary); }
      .context-menu-divider {
        height: 1px;
        background: rgba(255, 255, 255, 0.08);
        margin: 6px 0;
      }
      #playlist-submenu { max-height: 320px; overflow-y: auto; }
    </style>
</head>
<body>
    <div id="update-notification" class="update-notification" style="display: none;">
        <p>A new version of StreamGo is available! <span id="update-version"></span></p>
        <div class="update-actions">
            <button id="update-now-btn" class="btn btn-primary">Install Now</button>
            <button id="update-dismiss-btn" class="btn btn-secondary">Later</button>
        </div>
    </div>
    <div class="app-container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="currentColor">
                        <path d="M20 5L8 11v10c0 7.5 5.2 14.5 12 16.2 6.8-1.7 12-8.7 12-16.2V11l-12-6z"/>
                        <circle cx="20" cy="20" r="5" fill="white"/>
                    </svg>
                </div>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-section="home" title="Home">
                    <a href="#home">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                        </svg>
                    </a>
                </li>
                <li class="nav-item" data-section="search" title="Search">
                    <a href="#search">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                    </a>
                </li>
                <li class="nav-item" data-section="discover" title="Discover">
                    <a href="#discover">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2zm3.94 6.06-2.2 5.15a1 1 0 0 1-.53.53l-5.15 2.2a.25.25 0 0 1-.33-.33l2.2-5.15a1 1 0 0 1 .53-.53l5.15-2.2a.25.25 0 0 1 .33.33z"/>
                        </svg>
                    </a>
                </li>
                <li class="nav-item" data-section="library" title="Library">
                    <a href="#library">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/>
                        </svg>
                    </a>
                </li>
                <li class="nav-item" data-section="calendar" title="Calendar">
                    <a href="#calendar">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2zm-7 5h5v5h-5z"/>
                        </svg>
                    </a>
                </li>
                <li class="nav-item" data-section="playlists" title="Playlists">
                    <a href="#playlists">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/>
                        </svg>
                    </a>
                </li>
                <li class="nav-item" data-section="addons" title="Add-ons">
                    <a href="#addons">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"/>
                        </svg>
                    </a>
                </li>
                <li class="nav-item" data-section="diagnostics" title="Diagnostics">
                    <a href="#diagnostics">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/>
                            <path d="M20 20H4V4h7V2H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-7h-2v7z"/>
                        </svg>
                    </a>
                </li>
            </ul>
            <div class="sidebar-footer">
                <button id="theme-toggle" class="nav-item icon-btn-sidebar" title="Toggle theme">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                </button>
                <a href="#settings" class="nav-item" data-section="settings" title="Settings">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                    </svg>
                </a>
            </div>
        </nav>
        <main class="main-content">
            <header class="main-header">
                <div class="search-bar" style="position: relative;">
                    <input type="text" id="global-search" placeholder="">
                    <svg class="search-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                    </svg>
                    <button id="global-search-btn" class="search-btn-hidden">Search</button>
                    <div id="search-history-dropdown" class="search-history-dropdown" style="display: none;">
                        <div class="search-history-header">
                            <span>Recent searches</span>
                            <button id="clear-history-btn" class="clear-history-btn">Clear all</button>
                        </div>
                        <div id="search-history-list" class="search-history-list">
                            <!-- History items will be inserted here -->
                        </div>
                    </div>
                </div>
            </header>
            <div class="content-area">
                <!-- Svelte mount point (for migrated sections) -->
                <div id="svelte-root"></div>
                
                <!-- Home Section -->
                <section id="home-section" class="content-section active">
                    <div class="hero-section">
                        <div class="hero-content">
                            <h2 class="hero-title">Welcome to StreamGo</h2>
                            <p class="hero-description">Your modern media center for movies and TV shows. Search for content, build your library, and discover new favorites.</p>
                            <button class="btn btn-primary" id="start-searching-btn">Start Searching</button>
                        </div>
                    </div>
                    
                    <!-- Continue Watching Section -->
                    <div class="content-row" id="continue-watching-section" style="display: none;">
                        <div class="content-row-header">
                            <h3 class="content-row-title">Continue Watching</h3>
                        </div>
                        <div id="continue-watching-row" class="content-row-items">
                            <!-- Items will be loaded dynamically -->
                        </div>
                    </div>
                    
                    <!-- Recently Added Section -->
                    <div class="content-row" id="recent-library-section">
                        <div class="content-row-header">
                            <h3 class="content-row-title">Recently Added to Library</h3>
                            <a href="#library" class="content-row-see-all" onclick="app.showSection('library')">
                                See All
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                                </svg>
                            </a>
                        </div>
                        <div id="recent-library-row" class="content-row-items">
                            <!-- Items will be loaded dynamically -->
                        </div>
                    </div>
                    
                    <!-- Trending Section (placeholder) -->
                    <div class="content-row" id="trending-section" style="display: none;">
                        <div class="content-row-header">
                            <h3 class="content-row-title">🔥 Trending Now</h3>
                        </div>
                        <div id="trending-row" class="content-row-items">
                            <!-- Items will be loaded dynamically -->
                        </div>
                    </div>
                    
                    <!-- Popular Section (placeholder) -->
                    <div class="content-row" id="popular-section" style="display: none;">
                        <div class="content-row-header">
                            <h3 class="content-row-title">⭐ Popular</h3>
                        </div>
                        <div id="popular-row" class="content-row-items">
                            <!-- Items will be loaded dynamically -->
                        </div>
                    </div>
                </section>

                <!-- Search Section -->
                <section id="search-section" class="content-section">
                    <div class="search-header">
                        <h2>Search Movies & TV Shows</h2>
                        <div class="search-bar-large">
                            <input type="text" id="search-input" placeholder="Enter movie or TV show name...">
                            <button id="search-btn" class="btn btn-primary">Search</button>
                        </div>
                    </div>
                    <div id="search-results" class="movie-grid">
                        <p class="empty-message">Enter a search query to find movies and TV shows</p>
                    </div>
                    <div id="search-loading" class="loading-indicator" style="display: none;">
                        <p>Searching...</p>
                    </div>
                </section>

                <!-- Discover Section -->
                <section id="discover-section" class="content-section">
                    <div class="search-header">
                        <h2>Discover</h2>
                        <div class="search-bar-large" style="gap: 12px; flex-wrap: wrap;">
                            <select id="discover-type-select" class="setting-select" style="min-width: 150px;">
                                <option value="movie">🎬 Movies</option>
                                <option value="series">📺 Series</option>
                                <option value="channel">📹 Channels</option>
                                <option value="tv">📡 Live TV</option>
                            </select>
                            <select id="discover-catalog-select" class="setting-select" style="flex: 1; min-width: 250px;">
                                <option value="">Select a catalog...</option>
                            </select>
                        </div>
                        
                        <!-- Advanced Filters -->
                        <div class="discover-filters" style="margin-top: 16px; display: none;" id="discover-filters-panel">
                            <div style="display: flex; gap: 12px; flex-wrap: wrap; align-items: center;">
                                <!-- Search within catalog -->
                                <div style="flex: 1; min-width: 200px;" id="filter-search-container" style="display: none;">
                                    <input 
                                        type="text" 
                                        id="discover-search-input" 
                                        class="setting-select" 
                                        placeholder="Search in catalog..." 
                                        style="width: 100%;"
                                    />
                                </div>
                                
                                <!-- Genre filter -->
                                <div style="min-width: 180px;" id="filter-genre-container" style="display: none;">
                                    <select id="discover-genre-select" class="setting-select" style="width: 100%;">
                                        <option value="">All Genres</option>
                                    </select>
                                </div>
                                
                                <!-- Year filter -->
                                <div style="min-width: 140px;" id="filter-year-container" style="display: none;">
                                    <select id="discover-year-select" class="setting-select" style="width: 100%;">
                                        <option value="">All Years</option>
                                    </select>
                                </div>
                                
                                <!-- Apply/Clear buttons -->
                                <div style="display: flex; gap: 8px;">
                                    <button id="discover-apply-filters-btn" class="btn btn-primary">Apply Filters</button>
                                    <button id="discover-clear-filters-btn" class="btn btn-secondary">Clear</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="discover-grid" class="movie-grid">
                        <p class="empty-message">Select a catalog to browse content</p>
                    </div>
                    <div id="discover-loading" class="loading-indicator" style="display: none;">
                        <p>Loading...</p>
                    </div>
                    <div style="display:flex; justify-content:center; margin-top: 16px;">
                        <button id="discover-load-more" class="btn btn-secondary" style="display: none;">Load More</button>
                    </div>
                </section>

                <!-- Library Section -->
                <section id="library-section" class="content-section">
                    <div class="library-header">
                        <h2>Your Library</h2>
                        <p class="library-count"><span id="library-count">0</span> items</p>
                    </div>
                    <div id="library-grid" class="movie-grid">
                        <p class="empty-message">Your library is empty. Search for content and add it here!</p>
                    </div>
                </section>

                <!-- Calendar Section -->
                <section id="calendar-section" class="content-section">
                    <div class="calendar-header">
                        <h2>Calendar</h2>
                        <div class="calendar-controls">
                            <label for="calendar-days" class="calendar-label">Show</label>
                            <select id="calendar-days" class="setting-select">
                                <option value="7">Next 7 days</option>
                                <option value="14" selected>Next 14 days</option>
                                <option value="30">Next 30 days</option>
                            </select>
                            <button id="calendar-refresh-btn" class="btn btn-secondary">Refresh</button>
                        </div>
                    </div>
                    <div id="calendar-container" class="calendar-container">
                        <p class="empty-message">Upcoming episodes from your library will appear here.</p>
                    </div>
                </section>

                <!-- Playlists Section -->
                <section id="playlists-section" class="content-section">
                    <!-- Playlists List View -->
                    <div id="playlists-list-view">
                        <div class="playlists-header">
                            <h2>Your Playlists</h2>
                            <button id="create-playlist-btn" class="btn btn-primary">Create Playlist</button>
                        </div>
                        <div id="playlists-grid" class="playlists-grid">
                            <p class="empty-message">No playlists yet. Create one to get started!</p>
                        </div>
                    </div>

                    <!-- Playlist Detail View -->
                    <div id="playlist-detail-view" style="display: none;">
                        <button id="playlist-back-btn" class="back-btn">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10 20L0 10L10 0L11.775 1.775L3.55 10L11.775 18.225L10 20Z"/>
                            </svg>
                            Back to Playlists
                        </button>
                        <div class="playlist-detail-header">
                            <div class="playlist-detail-icon">
                                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 18V5l12-2v13M9 18l-4 1V6l4-1M9 18l12-2M9 9l12-2"/>
                                </svg>
                            </div>
                            <div class="playlist-detail-info">
                                <h2 id="playlist-detail-title">Playlist Name</h2>
                                <p id="playlist-detail-description" class="playlist-detail-description"></p>
                                <p id="playlist-detail-count" class="playlist-detail-meta">0 items</p>
                            </div>
                        </div>
                        <div id="playlist-detail-items" class="playlist-items">
                            <!-- Playlist items will be loaded here -->
                        </div>
                    </div>
                </section>

                <!-- Add-ons Section -->
                <section id="addons-section" class="content-section">
                    <div class="addons-header">
                        <h2>Add-ons</h2>
                        <div class="tabs">
                            <button class="tab-btn active" data-tab="installed">Installed</button>
                            <button class="tab-btn" data-tab="store">Discover Store</button>
                        </div>
                    </div>

                    <!-- Installed Tab -->
                    <div id="installed-addons-tab" class="tab-content active">
                        <div id="addons-list" class="addons-grid">
                            <p class="empty-message">Loading add-ons...</p>
                        </div>
                    </div>

                    <!-- Store Tab -->
                    <div id="store-addons-tab" class="tab-content" style="display: none;">
                        <!-- Install from URL Section -->
                        <div class="manifest-url-section">
                            <h3>📦 Install from Manifest URL</h3>
                            <p class="section-description">Install addons directly from their manifest URL (Stremio-compatible)</p>
                            <div class="manifest-url-input-group">
                                <input 
                                    type="url" 
                                    id="manifest-url-input" 
                                    class="manifest-url-input" 
                                    placeholder="https://tmdb-addon.strem.io/manifest.json"
                                    aria-label="Addon manifest URL"
                                />
                                <button id="preview-manifest-btn" class="btn btn-secondary">Preview</button>
                                <button id="install-from-url-btn" class="btn btn-primary">Install</button>
                            </div>
                            <div class="url-examples">
                                <p class="example-title">Quick Install:</p>
<button class="url-example-btn" data-url="https://v3-cinemeta.strem.io/manifest.json">Cinemeta (TMDB)</button>
                                <button class="url-example-btn" data-url="https://watchhub.strem.io/manifest.json">WatchHub</button>
                                <button class="url-example-btn" data-url="https://opensubtitles.strem.io/manifest.json">OpenSubtitles</button>
                            </div>
                        </div>

                        <!-- Store Header -->
                        <div class="store-header">
                            <h3>🏪 Community Addons</h3>
                            <div class="store-search-bar">
                                <input type="text" id="store-search-input" class="store-search-input" placeholder="Search addons..." />
                                <button id="store-search-btn" class="btn btn-secondary">Search</button>
                            </div>
                        </div>

                        <!-- Store Filters -->
                        <div class="store-filters">
                            <select id="store-category-filter" class="store-filter-select">
                                <option value="all">All Categories</option>
                                <option value="movies">Movies</option>
                                <option value="series">TV Series</option>
                                <option value="anime">Anime</option>
                                <option value="documentaries">Documentaries</option>
                                <option value="subtitles">Subtitles</option>
                                <option value="general">General</option>
                            </select>
                            <select id="store-sort-filter" class="store-filter-select">
                                <option value="featured">Featured</option>
                                <option value="popular">Most Popular</option>
                                <option value="rating">Highest Rated</option>
                                <option value="newest">Newest</option>
                                <option value="name">Name (A-Z)</option>
                            </select>
                            <label class="store-filter-checkbox">
                                <input type="checkbox" id="store-verified-only" />
                                <span>Verified only</span>
                            </label>
                        </div>

                        <!-- Store Grid -->
                        <div id="store-addons-grid" class="store-grid">
                            <p class="empty-message">Loading store addons...</p>
                        </div>
                    </div>
                </section>

                <!-- Media Detail Section -->
                <section id="detail-section" class="content-section">
                    <div class="detail-container">
                        <button class="back-btn" id="detail-back-btn">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10 20L0 10L10 0L11.775 1.775L3.55 10L11.775 18.225L10 20Z"/>
                            </svg>
                            Back
                        </button>
                        
                        <div class="detail-hero" id="detail-hero">
                            <!-- Backdrop will be inserted here -->
                        </div>
                        
                        <div class="detail-content" id="detail-content">
                            <!-- Detail info will be inserted here -->
                        </div>
                        
                        <!-- Video Player -->
                        <div id="video-player-container" class="video-player-container" style="display: none;">
                            <div class="player-header">
                                <button class="close-player-btn" id="close-player-btn">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                    </svg>
                                </button>
                                <div style="display: flex; flex-direction: column; gap: 4px;">
                                    <h3 id="player-title">Now Playing</h3>
                                    <div id="playlist-queue-info" style="display: none; font-size: 0.85em; opacity: 0.7;"></div>
                                </div>
                                <div class="player-controls-extras">
                                    <button id="external-player-btn" class="external-player-btn" title="Open in External Player" style="display: none;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                                        </svg>
                                    </button>
                                    <button id="pip-btn" class="pip-btn" title="Picture-in-Picture (P)">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M19 11h-8v6h8v-6zm4 8V4.98C23 3.88 22.1 3 21 3H3c-1.1 0-2 .88-2 1.98V19c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H3V4.97h18v14.05z"/>
                                        </svg>
                                    </button>
                                    <div id="quality-selector" class="quality-selector"></div>
                                    <div id="speed-selector" class="speed-selector">
                                        <button id="speed-toggle-btn" title="Playback Speed">1x</button>
                                    </div>
                                    <div id="subtitle-selector" class="subtitle-selector">
                                        <button id="subtitle-toggle-btn">CC</button>
                                    </div>
                                </div>
                            </div>
                            <video id="video-player" controls crossorigin="anonymous">
                                <source id="video-source" src="" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <div class="player-shortcuts-hint">
                                <small>⌨️ Shortcuts: Space/K=Play/Pause | P=PiP | F=Fullscreen | M=Mute | ←/→=Seek | ↑/↓=Volume | ESC=Close</small>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Catalog Browser Section -->
                <section id="catalog-view" class="content-section" style="display: none;">
                    <button id="catalog-back-btn" class="back-btn">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 20L0 10L10 0L11.775 1.775L3.55 10L11.775 18.225L10 20Z"/>
                        </svg>
                        Back to Addons
                    </button>
                    <div class="catalog-header">
                        <h2 id="catalog-title">Catalog</h2>
                    </div>
                    <div id="catalog-grid" class="movie-grid">
                        <p class="empty-message">Loading...</p>
                    </div>
                </section>

                <!-- Keyboard Shortcuts Modal -->
                <div id="shortcuts-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>⌨️ Keyboard Shortcuts</h3>
                            <button id="close-shortcuts-modal" class="close-btn">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="shortcuts-list">
                            <div class="shortcuts-section">
                                <h4>🎬 Video Playback</h4>
                                <div class="shortcut-item">
                                    <kbd>Space</kbd> or <kbd>K</kbd>
                                    <span>Play / Pause</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>F</kbd>
                                    <span>Toggle Fullscreen</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>M</kbd>
                                    <span>Mute / Unmute</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>P</kbd>
                                    <span>Picture-in-Picture</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>←</kbd> / <kbd>→</kbd>
                                    <span>Seek -10s / +10s</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>↑</kbd> / <kbd>↓</kbd>
                                    <span>Volume Up / Down</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>&lt;</kbd> / <kbd>&gt;</kbd>
                                    <span>Decrease / Increase Speed</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>D</kbd>
                                    <span>Toggle Streaming Stats</span>
                                </div>
                            </div>
                            <div class="shortcuts-section">
                                <h4>🧭 Navigation</h4>
                                <div class="shortcut-item">
                                    <kbd>/</kbd>
                                    <span>Focus Search</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>Esc</kbd>
                                    <span>Close Player / Modal</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>?</kbd>
                                    <span>Show This Help</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Media Context Menu -->
                <div id="media-context-menu" class="context-menu" style="display: none;">
                    <div class="context-menu-item" id="context-add-to-library">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        <span>Add to Library</span>
                    </div>
                    <div class="context-menu-item" id="context-add-to-watchlist">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                        <span>Add to Watchlist</span>
                    </div>
                    <div class="context-menu-divider"></div>
                    <div class="context-menu-item" id="context-add-to-playlist">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"/>
                        </svg>
                        <span>Add to Playlist</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-left: auto;">
                            <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                        </svg>
                    </div>
                    <div id="playlist-submenu" class="context-submenu" style="display: none;">
                        <div id="playlist-submenu-items">
                            <!-- Playlists will be loaded here -->
                        </div>
                        <div class="context-menu-divider"></div>
                        <div class="context-menu-item" id="context-create-new-playlist">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            <span>Create New Playlist</span>
                        </div>
                    </div>
                </div>

                <!-- Stream Picker Modal -->
                <div id="stream-picker-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="stream-picker-title">Select Stream</h3>
                            <button id="close-stream-picker" class="close-btn">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        </div>
                        <div id="stream-picker-list" class="stream-list">
                            <!-- Streams will be listed here -->
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <section id="settings-section" class="content-section">
                    <div class="settings-header">
                        <h2>Settings</h2>
                        <p class="settings-subtitle">Configure your StreamGo experience</p>
                    </div>
                    <div class="settings-content">
                        <!-- Appearance -->
                        <div class="settings-section">
                            <h3>🎨 Appearance</h3>
                            <div class="setting-item">
                                <label for="theme-select">Theme</label>
                                <select id="theme-select" class="setting-select">
                                    <option value="auto">Auto (System)</option>
                                    <option value="dark">Dark</option>
                                    <option value="light">Light</option>
                                    <option value="amoled">AMOLED (True Dark)</option>
                                    <option value="dracula">Dracula</option>
                                    <option value="solarized-light">Solarized Light</option>
                                    <option value="solarized-dark">Solarized Dark</option>
                                    <option value="nord">Nord</option>
                                </select>
                                <span class="setting-description">Choose your preferred color theme</span>
                            </div>
                        </div>

                        <!-- Video Settings -->
                        <div class="settings-section">
                            <h3>🎬 Video Settings</h3>
                            <div class="setting-item">
                                <label for="quality-select">Default Video Quality</label>
                                <select id="quality-select" class="setting-select">
                                    <option value="auto">Auto (Adaptive)</option>
                                    <option value="2160p">4K (2160p)</option>
                                    <option value="1440p">QHD (1440p)</option>
                                    <option value="1080p">Full HD (1080p)</option>
                                    <option value="720p">HD (720p)</option>
                                    <option value="480p">SD (480p)</option>
                                    <option value="360p">Low (360p)</option>
                                </select>
                                <span class="setting-description">Higher quality requires more bandwidth</span>
                            </div>
                            <div class="setting-item">
                                <label for="codec-select">Preferred Video Codec</label>
                                <select id="codec-select" class="setting-select">
                                    <option value="auto">Auto</option>
                                    <option value="h264">H.264 (AVC)</option>
                                    <option value="h265">H.265 (HEVC)</option>
                                    <option value="vp9">VP9</option>
                                    <option value="av1">AV1</option>
                                </select>
                                <span class="setting-description">H.265/AV1 offer better compression</span>
                            </div>
                            <div class="setting-item">
                                <label for="bitrate-select">Maximum Bitrate</label>
                                <select id="bitrate-select" class="setting-select">
                                    <option value="auto">Auto</option>
                                    <option value="50000">50 Mbps (4K HDR)</option>
                                    <option value="25000">25 Mbps (4K)</option>
                                    <option value="15000">15 Mbps (1080p High)</option>
                                    <option value="10000">10 Mbps (1080p)</option>
                                    <option value="5000">5 Mbps (720p)</option>
                                    <option value="3000">3 Mbps (480p)</option>
                                </select>
                                <span class="setting-description">Limit bandwidth usage</span>
                            </div>
                            <div class="setting-item">
                                <label for="hardware-accel-toggle">
                                    <input type="checkbox" id="hardware-accel-toggle" class="setting-checkbox" checked>
                                    <span>Enable hardware acceleration</span>
                                </label>
                                <span class="setting-description">Use GPU for better performance and lower CPU usage</span>
                            </div>
                        </div>

                        <!-- Audio Settings -->
                        <div class="settings-section">
                            <h3>🔊 Audio Settings</h3>
                            <div class="setting-item">
                                <label for="audio-codec-select">Preferred Audio Codec</label>
                                <select id="audio-codec-select" class="setting-select">
                                    <option value="auto">Auto</option>
                                    <option value="aac">AAC</option>
                                    <option value="ac3">AC3 (Dolby Digital)</option>
                                    <option value="eac3">E-AC3 (Dolby Digital Plus)</option>
                                    <option value="opus">Opus</option>
                                    <option value="vorbis">Vorbis</option>
                                </select>
                                <span class="setting-description">AAC recommended for compatibility</span>
                            </div>
                            <div class="setting-item">
                                <label for="audio-channels-select">Audio Channels</label>
                                <select id="audio-channels-select" class="setting-select">
                                    <option value="auto">Auto</option>
                                    <option value="stereo">Stereo (2.0)</option>
                                    <option value="5.1">Surround 5.1</option>
                                    <option value="7.1">Surround 7.1</option>
                                    <option value="atmos">Dolby Atmos</option>
                                </select>
                                <span class="setting-description">Match your audio system</span>
                            </div>
                            <div class="setting-item">
                                <label for="volume-normalize-toggle">
                                    <input type="checkbox" id="volume-normalize-toggle" class="setting-checkbox">
                                    <span>Normalize audio volume</span>
                                </label>
                                <span class="setting-description">Maintain consistent volume across content</span>
                            </div>
                        </div>

                        <!-- Playback -->
                        <div class="settings-section">
                            <h3>▶️ Playback</h3>
                            <div class="setting-item">
                                <label for="autoplay-toggle">
                                    <input type="checkbox" id="autoplay-toggle" class="setting-checkbox">
                                    <span>Autoplay next episode</span>
                                </label>
                                <span class="setting-description">Automatically play next episode in series</span>
                            </div>
                            <div class="setting-item">
                                <label for="skip-intro-toggle">
                                    <input type="checkbox" id="skip-intro-toggle" class="setting-checkbox">
                                    <span>Auto-skip intros</span>
                                </label>
                                <span class="setting-description">Skip opening credits automatically</span>
                            </div>
                            <div class="setting-item">
                                <label for="resume-playback-toggle">
                                    <input type="checkbox" id="resume-playback-toggle" class="setting-checkbox" checked>
                                    <span>Resume playback</span>
                                </label>
                                <span class="setting-description">Continue from where you left off</span>
                            </div>
                        </div>

                        <!-- Subtitles -->
                        <div class="settings-section">
                            <h3>📝 Subtitles</h3>
                            <div class="setting-item">
                                <label for="subtitles-toggle">
                                    <input type="checkbox" id="subtitles-toggle" class="setting-checkbox">
                                    <span>Enable subtitles by default</span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <label for="subtitle-language">Subtitle Language</label>
                                <select id="subtitle-language" class="setting-select">
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                    <option value="it">Italian</option>
                                    <option value="pt">Portuguese</option>
                                    <option value="ja">Japanese</option>
                                    <option value="ko">Korean</option>
                                    <option value="zh">Chinese (Simplified)</option>
                                    <option value="zh-TW">Chinese (Traditional)</option>
                                    <option value="ar">Arabic</option>
                                    <option value="ru">Russian</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label for="subtitle-size-select">Subtitle Size</label>
                                <select id="subtitle-size-select" class="setting-select">
                                    <option value="small">Small</option>
                                    <option value="medium">Medium</option>
                                    <option value="large">Large</option>
                                    <option value="xlarge">Extra Large</option>
                                </select>
                            </div>
                        </div>

                        <!-- Network & Streaming -->
                        <div class="settings-section">
                            <h3>🌐 Network & Streaming</h3>
                            <div class="setting-item">
                                <label for="buffer-size-select">Buffer Size</label>
                                <select id="buffer-size-select" class="setting-select">
                                    <option value="small">Small (5s)</option>
                                    <option value="medium">Medium (10s)</option>
                                    <option value="large">Large (20s)</option>
                                    <option value="xlarge">Extra Large (30s)</option>
                                </select>
                                <span class="setting-description">Larger buffer = less buffering but higher latency</span>
                            </div>
                            <div class="setting-item">
                                <label for="preload-toggle">
                                    <input type="checkbox" id="preload-toggle" class="setting-checkbox" checked>
                                    <span>Preload next episode</span>
                                </label>
                                <span class="setting-description">Reduce wait time between episodes</span>
                            </div>
                            <div class="setting-item">
                                <label for="torrent-connections-select">Max Torrent Connections</label>
                                <select id="torrent-connections-select" class="setting-select">
                                    <option value="50">50 (Low)</option>
                                    <option value="100">100 (Medium)</option>
                                    <option value="200">200 (High)</option>
                                    <option value="unlimited">Unlimited</option>
                                </select>
                                <span class="setting-description">For torrent-based add-ons</span>
                            </div>
                            <div class="setting-item">
                                <label for="cache-size-select">Cache Size</label>
                                <select id="cache-size-select" class="setting-select">
                                    <option value="512">512 MB</option>
                                    <option value="1024">1 GB</option>
                                    <option value="2048">2 GB</option>
                                    <option value="4096">4 GB</option>
                                </select>
                                <span class="setting-description">Disk space for caching media</span>
                            </div>
                        </div>

                        <!-- Advanced -->
                        <div class="settings-section">
                            <h3>⚙️ Advanced</h3>
                            <div class="setting-item">
                                <label for="player-engine-select">Player Engine</label>
                                <select id="player-engine-select" class="setting-select">
                                    <option value="auto">Auto</option>
                                    <option value="html5">HTML5 Video</option>
                                    <option value="mpv">MPV</option>
                                    <option value="vlc">VLC</option>
                                </select>
                                <span class="setting-description">Video playback engine</span>
                            </div>
                            <div class="setting-item">
                                <label for="logging-toggle">
                                    <input type="checkbox" id="logging-toggle" class="setting-checkbox">
                                    <span>Enable debug logging</span>
                                </label>
                                <span class="setting-description">Useful for troubleshooting</span>
                            </div>
                            <div class="setting-item">
                                <label for="analytics-toggle">
                                    <input type="checkbox" id="analytics-toggle" class="setting-checkbox">
                                    <span>Send anonymous usage statistics</span>
                                </label>
                                <span class="setting-description">Help improve StreamGo</span>
                            </div>
                        </div>

                        <!-- Notifications -->
                        <div class="settings-section">
                            <h3>🔔 Notifications</h3>
                            <div class="setting-item">
                                <label for="notifications-toggle">
                                    <input type="checkbox" id="notifications-toggle" class="setting-checkbox" checked>
                                    <span>Enable episode notifications</span>
                                </label>
                                <span class="setting-description">Get notified when new episodes of your library shows are available</span>
                            </div>
                            <div class="setting-item">
                                <button class="btn btn-secondary" id="check-episodes-now-btn">🔄 Check Now</button>
                                <span class="setting-description">Manually check for new episodes</span>
                            </div>
                        </div>

                        <!-- Data Management -->
                        <div class="settings-section">
                            <h3>💾 Data Management</h3>
                            <div class="setting-item">
                                <label>Export Your Data</label>
                                <button class="btn btn-primary" id="export-data-btn">📤 Export Data</button>
                                <span class="setting-description">Download your library, watched history, and settings as JSON</span>
                            </div>
                            <div class="setting-item">
                                <label>Import Data</label>
                                <input type="file" id="import-data-file" accept=".json" style="display: none;" />
                                <button class="btn btn-secondary" id="import-data-btn">📥 Import Data</button>
                                <span class="setting-description">Restore from a previously exported JSON file</span>
                            </div>
                        </div>

                        <div class="settings-actions">
                            <button class="btn btn-primary" id="settings-save-btn">💾 Save Settings</button>
                            <button class="btn btn-secondary" id="settings-reset-btn">🔄 Reset to Defaults</button>
                            <button class="btn btn-secondary" id="settings-clear-cache-btn">🗑️ Clear Cache</button>
                        </div>
                    </div>
                </section>

                <!-- Diagnostics Section -->
                <section id="diagnostics-section" class="content-section">
                    <div id="diagnostics-container">
                        <!-- Diagnostics will be rendered here by diagnostics.ts -->
                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <!-- Onboarding Modal -->
    <div id="onboarding-modal" class="onboarding-modal" style="display: none;">
        <div class="onboarding-content">
            <!-- Step 1: Welcome -->
            <div class="onboarding-step" data-step="1">
                <div class="onboarding-icon">🎬</div>
                <h2>Welcome to StreamGo!</h2>
                <p class="onboarding-description">
                    Your modern media center for discovering and watching movies and TV shows.
                    Let's get you set up in just a few steps.
                </p>
                <div class="onboarding-actions">
                    <button class="btn btn-primary onboarding-next">Get Started</button>
                </div>
            </div>

            <!-- Step 2: Install Default Addon -->
            <div class="onboarding-step" data-step="2" style="display: none;">
                <div class="onboarding-icon">📦</div>
                <h2>Install Content Source</h2>
                <p class="onboarding-description">
                    StreamGo uses addons to provide content. We'll install Cinemeta,
                    the official addon that provides movie and TV show information from TMDB.
                </p>
                <div class="onboarding-addon-preview">
                    <div class="addon-preview-card">
                        <h3>Cinemeta</h3>
                        <p>Official TMDB addon with comprehensive movie and TV data</p>
                        <div class="addon-features">
                            <span class="feature-badge">🎬 Movies</span>
                            <span class="feature-badge">📺 TV Shows</span>
                            <span class="feature-badge">⭐ Ratings</span>
                        </div>
                    </div>
                </div>
                <div class="onboarding-actions">
                    <button class="btn btn-secondary onboarding-back">Back</button>
                    <button class="btn btn-primary onboarding-install-addon">Install & Continue</button>
                </div>
            </div>

            <!-- Step 3: Pick Genres -->
            <div class="onboarding-step" data-step="3" style="display: none;">
                <div class="onboarding-icon">🎭</div>
                <h2>Choose Your Favorites</h2>
                <p class="onboarding-description">
                    Select the genres you enjoy to help us personalize your experience.
                </p>
                <div class="onboarding-genres">
                    <button class="genre-pill" data-genre="action">Action</button>
                    <button class="genre-pill" data-genre="adventure">Adventure</button>
                    <button class="genre-pill" data-genre="animation">Animation</button>
                    <button class="genre-pill" data-genre="comedy">Comedy</button>
                    <button class="genre-pill" data-genre="crime">Crime</button>
                    <button class="genre-pill" data-genre="documentary">Documentary</button>
                    <button class="genre-pill" data-genre="drama">Drama</button>
                    <button class="genre-pill" data-genre="fantasy">Fantasy</button>
                    <button class="genre-pill" data-genre="horror">Horror</button>
                    <button class="genre-pill" data-genre="mystery">Mystery</button>
                    <button class="genre-pill" data-genre="romance">Romance</button>
                    <button class="genre-pill" data-genre="sci-fi">Sci-Fi</button>
                    <button class="genre-pill" data-genre="thriller">Thriller</button>
                    <button class="genre-pill" data-genre="western">Western</button>
                </div>
                <div class="onboarding-actions">
                    <button class="btn btn-secondary onboarding-back">Back</button>
                    <button class="btn btn-primary onboarding-next">Continue</button>
                </div>
            </div>

            <!-- Step 4: Quick Tour -->
            <div class="onboarding-step" data-step="4" style="display: none;">
                <div class="onboarding-icon">🧭</div>
                <h2>Quick Tour</h2>
                <div class="onboarding-tour">
                    <div class="tour-item">
                        <div class="tour-icon">🔍</div>
                        <h3>Search</h3>
                        <p>Find movies and TV shows instantly</p>
                    </div>
                    <div class="tour-item">
                        <div class="tour-icon">🌟</div>
                        <h3>Discover</h3>
                        <p>Browse catalogs from your addons</p>
                    </div>
                    <div class="tour-item">
                        <div class="tour-icon">📚</div>
                        <h3>Library</h3>
                        <p>Save your favorites to watch later</p>
                    </div>
                    <div class="tour-item">
                        <div class="tour-icon">⌨️</div>
                        <h3>Shortcuts</h3>
                        <p>Press <kbd>?</kbd> to see keyboard shortcuts</p>
                    </div>
                </div>
                <div class="onboarding-actions">
                    <button class="btn btn-secondary onboarding-back">Back</button>
                    <button class="btn btn-primary onboarding-finish">Start Using StreamGo</button>
                </div>
            </div>

            <!-- Progress Indicator -->
            <div class="onboarding-progress">
                <div class="progress-dot active" data-dot="1"></div>
                <div class="progress-dot" data-dot="2"></div>
                <div class="progress-dot" data-dot="3"></div>
                <div class="progress-dot" data-dot="4"></div>
            </div>

            <!-- Skip Button -->
            <button class="onboarding-skip">Skip Setup</button>
        </div>
    </div>
    
    <script type="module" src="/main.ts"></script>
</body>
</html>
